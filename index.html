<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Snowy Secret</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: #101430;
      color: #ffffff;
      font-family: "Courier New", monospace;
      image-rendering: pixelated;
    }

    /* Optional: use your Undertale screenshot as the page background */
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background:
        #101430 url("bg-forest.png") center/cover no-repeat;
      opacity: 0.35;
      z-index: -1;
    }

    .title {
      font-size: 18px;
      margin-bottom: 8px;
      letter-spacing: 2px;
    }

    .subtitle {
      font-size: 12px;
      margin-bottom: 12px;
    }

    .frame {
      position: relative;
      width: min(95vw, 640px);
      aspect-ratio: 4 / 3;
      border: 4px solid #ffffff;
      box-shadow: 0 0 0 2px #0b1228 inset;
      background: #202744;
      overflow: hidden;
      image-rendering: pixelated;
    }

    .frame-inner-border {
      position: absolute;
      inset: 3px;
      border: 2px solid #b0c8ff;
      pointer-events: none;
    }

    .gift-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    canvas {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      display: block;
      image-rendering: pixelated;
    }

    /* ðŸ‘‡ Your penguin cursor goes here */
    #maskCanvas {
      cursor: url("penguin-cursor.png") 16 16, auto;
    }

    #flakesCanvas {
      pointer-events: none;
    }

    .hint-bar {
      margin-top: 10px;
      padding: 4px 10px;
      border: 2px solid #ffffff;
      background: #151935;
      font-size: 11px;
      max-width: 640px;
      text-align: left;
    }
  </style>
</head>
<body>
  <div class="title">* SNOWY GIFT AREA *</div>
  <div class="subtitle">Move the penguin to brush away the snow...</div>

  <div class="frame">
    <!-- ðŸ‘‡ 1) YOUR GIFT IMAGE -->
    <!-- Replace "gift.png" with your real file name -->
    <img src="gift.png" alt="Secret Gift" class="gift-image" />

    <!-- ðŸ‘‡ 2) SCRATCH-OFF SNOW LAYER -->
    <canvas id="maskCanvas"></canvas>

    <!-- ðŸ‘‡ 3) FALLING SNOW PIXELS -->
    <canvas id="flakesCanvas"></canvas>

    <div class="frame-inner-border"></div>
  </div>

  <div class="hint-bar">
    <span>* TIP *</span> Use your mouse (or finger on mobile) to slowly clear the snowy path and reveal whatâ€™s waiting for you.
  </div>

  <script>
    const maskCanvas = document.getElementById("maskCanvas");
    const maskCtx = maskCanvas.getContext("2d");

    const flakesCanvas = document.getElementById("flakesCanvas");
    const flakesCtx = flakesCanvas.getContext("2d");

    let isDrawing = false;
    const brushRadius = 10; // smaller brush for more "scratching"

    // ---------- RESIZE ----------
    function resizeCanvases() {
      const rect = maskCanvas.getBoundingClientRect();
      const dpr = window.devicePixelRatio || 1;

      maskCanvas.width = rect.width * dpr;
      maskCanvas.height = rect.height * dpr;
      maskCtx.setTransform(dpr, 0, 0, dpr, 0, 0);

      flakesCanvas.width = rect.width * dpr;
      flakesCanvas.height = rect.height * dpr;
      flakesCtx.setTransform(dpr, 0, 0, dpr, 0, 0);

      drawSnowMask();
      initFlakes(rect.width, rect.height);
    }

    // ---------- UNDERTALE-ISH SNOW MASK ----------
    function drawSnowMask() {
      const rect = maskCanvas.getBoundingClientRect();
      const w = rect.width;
      const h = rect.height;

      maskCtx.globalCompositeOperation = "source-over";
      maskCtx.clearRect(0, 0, w, h);

      // base snowy blue
      maskCtx.fillStyle = "#7f8fb4";
      maskCtx.fillRect(0, 0, w, h);

      const tile = 12; // pixel block size
      for (let y = 0; y < h; y += tile) {
        for (let x = 0; x < w; x += tile) {
          // palette similar to Undertale snow
          const colors = ["#b7c7e5", "#a7b7d8", "#8e9ac5", "#d5e0ff"];
          const c = colors[Math.floor(Math.random() * colors.length)];
          maskCtx.fillStyle = c;
          maskCtx.fillRect(x, y, tile, tile);
        }
      }

      // darker "path" hint in the middle
      maskCtx.fillStyle = "#6c7aa0";
      const pathHeight = h * 0.45;
      const pathY = (h - pathHeight) / 2;
      maskCtx.fillRect(w * 0.2, pathY, w * 0.6, pathHeight);
    }

    function eraseAt(clientX, clientY) {
      const rect = maskCanvas.getBoundingClientRect();
      const x = clientX - rect.left;
      const y = clientY - rect.top;

      maskCtx.globalCompositeOperation = "destination-out";
      maskCtx.beginPath();
      maskCtx.arc(x, y, brushRadius, 0, Math.PI * 2);
      maskCtx.fill();
    }

    // Mouse
    maskCanvas.addEventListener("mousedown", (e) => {
      isDrawing = true;
      eraseAt(e.clientX, e.clientY);
    });

    maskCanvas.addEventListener("mousemove", (e) => {
      if (!isDrawing) return;
      eraseAt(e.clientX, e.clientY);
    });

    window.addEventListener("mouseup", () => {
      isDrawing = false;
    });

    // Touch
    maskCanvas.addEventListener("touchstart", (e) => {
      e.preventDefault();
      isDrawing = true;
      const t = e.touches[0];
      eraseAt(t.clientX, t.clientY);
    }, { passive: false });

    maskCanvas.addEventListener("touchmove", (e) => {
      e.preventDefault();
      if (!isDrawing) return;
      const t = e.touches[0];
      eraseAt(t.clientX, t.clientY);
    }, { passive: false });

    window.addEventListener("touchend", () => {
      isDrawing = false;
    });

    // ---------- FALLING PIXEL SNOW ----------
    let flakes = [];
    function initFlakes(width, height) {
      const count = 90;
      flakes = [];
      for (let i = 0; i < count; i++) {
        flakes.push({
          x: Math.random() * width,
          y: Math.random() * height,
          size: 2 + Math.random() * 2,
          speedY: 0.4 + Math.random() * 0.8,
          driftX: (Math.random() - 0.5) * 0.25
        });
      }
    }

    function animateSnow() {
      const rect = flakesCanvas.getBoundingClientRect();
      const w = rect.width;
      const h = rect.height;

      flakesCtx.clearRect(0, 0, w, h);

      flakesCtx.fillStyle = "#ffffff";
      for (let flake of flakes) {
        flakesCtx.fillRect(flake.x, flake.y, flake.size, flake.size);

        flake.y += flake.speedY;
        flake.x += flake.driftX;

        if (flake.y > h + 5) {
          flake.y = -10;
          flake.x = Math.random() * w;
        }
        if (flake.x < -10) flake.x = w + 10;
        if (flake.x > w + 10) flake.x = -10;
      }

      requestAnimationFrame(animateSnow);
    }

    // ---------- INIT ----------
    window.addEventListener("resize", resizeCanvases);
    resizeCanvases();
    requestAnimationFrame(animateSnow);
  </script>
</body>
</html>
